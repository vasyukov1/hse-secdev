# Сценарии приемки Security NFR

```gherkin
Feature: Защита от brute-force атак
  Scenario: Блокировка IP при превышении лимита запросов
    Given IP адрес
    When происходит 6 попыток входа в течение 1 минуты
    Then возвращается HTTP 429 Too Many Requests
    And IP блокируется на 15 минут

  Scenario: Успешный запрос в пределах лимита
    Given IP адрес
    When происходит 3 попытки входа в течение 1 минуты
    Then возвращается корректный HTTP ответ (200/401)
```

```gherkin
Feature: Безопасность паролей
  Scenario: Пароль хэшируется с правильными параметрами
    Given новый пользователь с паролем
    When пароль сохраняется в базу данных
    Then он хэшируется алгоритмом Argon2id с параметрами t=3, m=64MB, p=2
    And исходный пароль не сохраняется
```

```gherkin
Feature: Производительность под нагрузкой
  Scenario: Отклик API в пределах SLA
    Given сервис развернут на staging
    When запускается нагрузочный тест 30 RPS в течение 5 минут
    Then p95 времени ответа ≤ 500ms для всех эндпоинтов
    And процент ошибок ≤ 1%
```

```gherkin
Feature: Валидация входных данных API
  Scenario: Успешная валидация корректных данных
    Given корректные данные медиа-элемента
    When отправляется POST /media
    Then данные проходят валидацию
    And возвращается HTTP 201 Created

  Scenario: Отклонение некорректных данных
    Given данные с названием длиной 300 символов
    When отправляется POST /media
    Then возвращается HTTP 422 Unprocessable Entity
```
